---
# tasks file for pentest
- name: Install prerequisites
  become: true
  apt:
    update_cache: true
    install_recommends: false
    pkg:
      - firefox
      - httpie
      - libegl1
      - libxtst6
      - nmap
      - openvpn

- name: Create wordlist directory
  become: true
  ansible.builtin.file:
    path: '{{ wordlist_path }}'
    state: directory

- name: Download wordlists
  become: true
  git:
    repo: https://github.com/3ndG4me/KaliLists.git
    dest: '{{ wordlist_path }}'
    update: true

- name: Modify wordlists owner
  become: true
  ansible.builtin.file:
    path: '{{ wordlist_path }}'
    state: directory
    recurse: true
    owner: vagrant
    group: vagrant


- name: Add ffuf
  shell: >
    . ~/.profile 
    && go get -u github.com/ffuf/ffuf


- name: Download BurpSuite
  get_url:
    url: 'https://portswigger.net/burp/releases/download?product=community&version={{ burpsuite_version }}&type=Linux'
    dest: /tmp/burpsuite_community_linux_v{{ burpsuite_version | regex_replace('\.', '_') }}.sh

- name: Install BurpSuite
  shell: >
    echo "\n\n\n\n" | bash /tmp/burpsuite_community_linux_v{{ burpsuite_version | regex_replace('\.', '_') }}.sh -c

- name: Create symbolic link to BurpSuite
  become: true
  ansible.builtin.file:
    src: '/home/{{ ansible_env.USER }}/BurpSuiteCommunity/BurpSuiteCommunity'
    dest: /usr/bin/burp
    state: link

- name: Download Metasploit
  get_url:
    url: https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb
    dest: /tmp/msfinstall
    mode: 0755

- name: Install Metasploit
  shell: >
    /tmp/msfinstall

